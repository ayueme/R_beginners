---
title: "数值和字符串处理"
---

## 数值处理

### 计算函数

常见的计算函数：

```{r}
x <- c(1,2,3,4,5)

sum(x) # 求和
mean(x) # 平均数
median(x)      # 中位数
sd(x) # 标准差
var(x) # 方差
mad(x) # 绝对中位差 median absolute deviation
quantile(x,probs = c(0.05,0.95)) # 分位数
range(x) # 范围
min(x) # 最小值
max(x) # 最大值
scale(x) # 中心化，标准化
# ?scale
```

### 概率函数(选学)

由两部分组成：

- d：密度函数（density）
- p：分布函数（distribution）
- q：分位数函数（quantile）
- r：随机函数（random）

![](figs/PixPin_2024-07-27_10-42-44.png)

随机正态分布：

```{r}
rnorm(20, mean = 0, sd = 1)
```

密度正态分布：

```{r}
dnorm(20, mean = 0, sd = 1)
```

随机均匀分布：

```{r}
runif(20, min = 10, max = 80)
```

随机过程无法复现，但是可以通过设置随机种子数复现（所以计算机里面的随机是伪随机）：

```{r}
# 设置随机种子数，你的结果就能和我一样了
set.seed(123)
rnorm(20, mean = 0, sd = 1)
```

## 字符串处理

常用的字符处理函数：

![](figs/PixPin_2024-08-01_19-21-17.png)

以第5章导入的TCGA乳腺癌数据为例。先读取数据：

```{r}
df <- read.csv("datasets/brca_clin.csv", header = T)

# 检查下数据的基本结构
dim(df)
str(df)
head(df)
```

计算字符数量：

```{r}
x <- df$barcode[1:3]
x

nchar(x)
```

截取字符串、替换字符串：

```{r}
x <- df$barcode[1]
x

substr(x, start = 1, stop = 15)
substr(x, start = 1, stop = 3) <- "ggg"
x
```

查找字符串：

```{r}
x <- c(df$barcode[1:3], "hahahaha")
x

grep("TCGA", x)

grepl("TCGA", x)
```

搜索替换，横岗变成下划线：

```{r}
x <- df$barcode[1:5]
x

sub("-","_",x)
gsub("-","_",x)
```

分割字符串：

```{r}
x <- df$barcode[1]
x

strsplit(x, split = "-")
```

连接字符串：

```{r}
x <- c()
paste("haha",1:3,sep = "")
paste("haha",1:3,sep = " ")
paste("haha",1:3,sep = "OOO")
paste("今天是",date())

paste0("haha",1:3)
```

大小写转换：

```{r}
x <- c("asdf","asdf","ghb")
toupper(x)

x <- c("SADFf","FAFFaa")
tolower(x)
```

:::{.callout-note}
更高级的字符处理技术请学习R包`stringr`和正则表达式，非常强大！
:::
